<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <title>Sign Up | Scentify</title>

    <link rel="stylesheet" th:href="@{/webjars/bootstrap/5.3.0/css/bootstrap.min.css}">
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@500;600&family=Inter:wght@300;400;500&display=swap" rel="stylesheet">

    <style>
        body { font-family: 'Inter', sans-serif; background: #fdfcfa; }
        .brand-panel {
            background:
                linear-gradient(rgba(247,242,239,0.92), rgba(247,242,239,0.92)),
                url("https://images.unsplash.com/photo-1594035910387-fea47794261f");
            background-size: cover;
            background-position: center;
        }
        .brand-title { font-family: 'Playfair Display', serif; }
        .signup-card { border-radius: 18px; box-shadow: 0 25px 60px rgba(0,0,0,0.08); }
        .form-control { border-radius: 12px; }
        .btn-scentify { background: linear-gradient(135deg, #c2a98d, #b49374); }
        .role-option { border: 2px solid #ddd; border-radius: 14px; padding: 14px; cursor: pointer; text-align: center; }
        .role-option.selected { border-color: #c2a98d; background: #f7f2ef; }
        .form-section { display: none; }
        .form-section.active { display: block; }
        .upload-area { border: 2px dashed #ddd; border-radius: 14px; padding: 18px; cursor: pointer; }
    </style>
</head>

<body>
<div class="container-fluid min-vh-100">
    <div class="row h-100">

        <div class="col-lg-6 d-none d-lg-flex align-items-center justify-content-center brand-panel">
            <div class="text-center">
                <h1 class="brand-title display-4">Scentify</h1>
                <p class="lead">Discover your signature scent.</p>
            </div>
        </div>

        <div class="col-lg-6 d-flex align-items-center justify-content-center">
            <div class="col-md-10 col-lg-8">
                <div class="card signup-card">
                    <div class="card-body">

                        <h3 class="text-center mb-3">Create Account</h3>

                        <form th:action="@{/signup}" method="post" enctype="multipart/form-data">

                            <!-- ROLE -->
                            <input type="hidden" id="roleInput" name="role" value="customer">

                            <div class="d-flex gap-2 mb-3">
                                <label class="role-option flex-fill selected" data-role="customer">üõçÔ∏è<br><b>Customer</b></label>
                                <label class="role-option flex-fill" data-role="supplier">üì¶<br><b>Supplier</b></label>
                            </div>

                            <!-- CUSTOMER -->
                            <div id="customerForm" class="form-section active">
                                <input class="form-control mb-2" name="fullname" placeholder="Full name">
                                <input class="form-control mb-2" name="username" placeholder="Username">
                                <input class="form-control mb-2" type="email" name="email" placeholder="Email">
                                <input class="form-control mb-2" type="password" name="password" placeholder="Password">
                                <input class="form-control mb-2" type="password" name="confirmPassword" placeholder="Confirm password">
                            </div>

                            <!-- SUPPLIER -->
                            <div id="supplierForm" class="form-section">
                                <input class="form-control mb-2" name="fullname" placeholder="Brand name">
                                <input class="form-control mb-2" name="username" placeholder="Username">
                                <input class="form-control mb-2" type="email" name="email" placeholder="Email">
                                <input class="form-control mb-2" type="password" name="password" placeholder="Password">
                                <input class="form-control mb-2" type="password" name="confirmPassword" placeholder="Confirm password">

                                <div class="upload-area mt-3" id="uploadArea">
                                    üìÑ Upload business proof (PDF)
                                    <input type="file" id="businessProof" name="businessProof" hidden accept=".pdf">
                                </div>
                                <small id="fileName"></small>
                            </div>

                            <button type="submit" id="submitBtn" class="btn btn-scentify w-100 text-white mt-3">
                                Create Account
                            </button>

                        </form>

                        <p class="text-center mt-3">
                            Already have an account? <a href="/login">Login</a>
                        </p>

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    const customerForm = document.getElementById('customerForm');
    const supplierForm = document.getElementById('supplierForm');
    const roleInput = document.getElementById('roleInput');
    const submitBtn = document.getElementById('submitBtn');
    const businessProof = document.getElementById('businessProof');
    const fileName = document.getElementById('fileName');
    const roleOptions = document.querySelectorAll('.role-option');

    function toggleInputs(section, enabled) {
        section.querySelectorAll('input').forEach(input => {
            if (input !== roleInput) {
                input.disabled = !enabled;
            }
        });
    }

    function activateCustomer() {
        roleInput.value = 'customer';

        customerForm.classList.add('active');
        supplierForm.classList.remove('active');

        toggleInputs(customerForm, true);
        toggleInputs(supplierForm, false);

        businessProof.disabled = true;
        submitBtn.textContent = 'Create Account';
    }

    function activateSupplier() {
        roleInput.value = 'supplier';

        supplierForm.classList.add('active');
        customerForm.classList.remove('active');

        toggleInputs(supplierForm, true);
        toggleInputs(customerForm, false);

        businessProof.disabled = false;
        submitBtn.textContent = 'Submit Application';
    }

    // INITIAL STATE ‚Äî IMPORTANT
    document.addEventListener('DOMContentLoaded', () => {
        activateCustomer();
    });

    // ROLE CLICK HANDLERS
    roleOptions.forEach(option => {
        option.addEventListener('click', () => {
            roleOptions.forEach(o => o.classList.remove('selected'));
            option.classList.add('selected');

            if (option.dataset.role === 'supplier') {
                activateSupplier();
            } else {
                activateCustomer();
            }
        });
    });

    // FILE UPLOAD
    document.getElementById('uploadArea').onclick = () => businessProof.click();
    businessProof.onchange = e => {
        fileName.textContent = e.target.files[0]?.name || '';
    };
</script>

</body>
</html>
